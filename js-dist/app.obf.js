class PsychTestApp{mW81(){this.currentTest = null;this.currentAnswers = [];this.tests = [];this.init();}init(){this.mWSC();this.mGL8();this.mk1q();this.mdEt();}mWSC(){document.getElementById('searchBtn')?.addEventListener('click',()=> this.ml44());document.getElementById('vR8R')?.addEventListener('keypress',(e)=>{if(e.key === 'Enter')this.ml44();});document.querySelectorAll('.tab').forEach(tab =>{tab.addEventListener('click',(e)=> this.min8(e));});document.getElementById('shareIcon')?.addEventListener('click',()=>{this.mqmb();});}mqmb(){let vBn8 = window.location.href;if(navigator.clipboard && navigator.clipboard.writeText){navigator.clipboard.writeText(vBn8).then(()=>{this.mJQ0('分享链接已复制，快去分享给好友吧！');}).catch(err =>{console.error('复制失败:',err);this.mJQ0('复制失败，请手动复制链接');});}else{let vEa4 = document.createElement('textarea');vEa4.value = vBn8;vEa4.style.position = 'fixed';document.body.appendChild(vEa4);vEa4.focus();vEa4.select();try{let vb5E = document.execCommand('copy');if(vb5E){this.mJQ0('分享链接已复制，快去分享给好友吧！');}else{this.mJQ0('复制失败，请手动复制链接');}}mGWJ(err){console.error('复制失败:',err);this.mJQ0('复制失败，请手动复制链接');}document.body.removeChild(vEa4);}}mGL8(){this.tests = [{id:'1',title:'你的精神老家',description:'你的性格最适合居住在哪个城市？',category:'fun',templateType:'fun',price:0.9,questions:10,image:'images/test1.jpg'},{id:'2',title:'你在异世界的职业',description:'解锁你的隐藏天赋，发现异世界命定身份！',category:'fun',templateType:'fun',price:0.9,questions:9,image:'images/test2.jpg'},{id:'3',title:'你是什么型恋人',description:'你是独立猫猫型还是阳光树懒型？探索你的亲密关系模式',category:'fun',templateType:'fun',price:0.9,questions:10,image:'images/test3.jpg'},{id:'4',title:'大明王朝职场生存人格',description:'测一测你是《大明王朝1566》里的谁？',category:'fun',templateType:'fun',price:0.9,questions:12,image:'images/test4.jpg'},{id:'5',title:'职业优势识别器（专业版）',description:'发现你的天赋和优势能力，为你导航职业未来',category:'standard',templateType:'standard',price:9.9,questions:48,image:'images/test5.jpg'},{id:'6',title:'SCL-90心理健康测试（专业版）',description:'90题全面扫描你的心理健康状态，提供改善方案',category:'standard',templateType:'standard',price:9.9,questions:90,image:'images/test6.jpg'},{id:'7',title:'动物人格测试',description:'揭秘你的灵魂动物原型',category:'fun',templateType:'fun',price:0.5,questions:60,image:'images/test7.jpg'},{id:'8',title:'精神需求测试',description:'你最核心的精神驱动力是什么？是权力金钱还是爱？',category:'fun',templateType:'fun',price:0.5,questions:60,image:'images/test8.jpg'}];}mk1q(){this.mskn();this.mv9G();}mskn(){let vYpl = document.getElementById('vv3V');if(vYpl){let vmn0 = ['4','5'];let vv3V = this.tests.filter(test => vmn0.includes(test.id));vYpl.innerHTML = vv3V.map(test => ` <div class="test-card" data-test-id="${test.id}"> <div class="test-image" style="background-image:url('${test.image}');background-size:cover;background-position:center;"></div> <div class="test-content"> <div class="test-vXLw">${test.title}</div> <button class="test-btn" onclick="app.navigateToTest('${test.id}')">前往 →</button> </div> </div> `).join('');vYpl.querySelectorAll('.test-card').forEach(card =>{card.addEventListener('click',(e)=>{if(!e.target.classList.contains('test-btn')){let vlB4 = card.dataset.testId;this.mK29(vlB4);}});});}}mv9G(){let vo9M = document.getElementById('testList');if(vo9M){vo9M.innerHTML = this.tests.map(test => ` <div class="test-list-item" data-test-id="${test.id}" data-vT1j="${test.category}"> <div class="test-thumb" style="background-image:url('${test.image}');background-size:cover;background-position:center;"></div> <div class="test-info"> <div class="test-vXLw">${test.title}</div> <div class="test-vqk8">${test.description}</div> </div> <button class="small-btn" onclick="app.navigateToTest('${test.id}')">前往</button> </div> `).join('');vo9M.querySelectorAll('.test-list-item').forEach(item =>{item.addEventListener('click',(e)=>{if(!e.target.classList.contains('small-btn')){let vlB4 = item.dataset.testId;this.mK29(vlB4);}});});}}mZ98(vlB4){let vCL1 = this.msN8();return vCL1.some(vX04 => vX04.testId === vlB4);}msN8(){let vCL1 = [];mS3g(let i = 0;i < localStorage.length;i++){const key = localStorage.key(i);if(key && key.startsWith('test_result_')){try{let vX04 = JSON.parse(localStorage.getItem(key));if(vX04 && vX04.data){vCL1.push({testId:vX04.data.testId || 'unknown',timestamp:vX04.timestamp,resultId:key.replace('test_result_','')});}}mGWJ(e){console.error('解析测试结果失败:',e);}}}return vCL1;}mK29(vlB4){window.location.href = `detail.html?id=${vlB4}`;}ml44(){let vR8R = document.getElementById('vR8R');let vwL8 = vR8R.value.trim();if(vwL8){this.mPk2(vwL8);this.mJQ0(`搜索:${vwL8}`);}}min8(event){const tab = event.currentTarget;let vT1j = tab.dataset.category;document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));tab.classList.add('active');this.mI34(vT1j);}mI34(vT1j){let vgo6 = document.querySelectorAll('.test-list-item');vgo6.forEach(item =>{let vq7J = item.dataset.category;if(vT1j === 'all' || vq7J === vT1j){item.style.display = 'flex';}else{item.style.display = 'none';}});}mPk2(vwL8){let vgo6 = document.querySelectorAll('.test-list-item');let vAc9 = vwL8.toLowerCase();vgo6.forEach(item =>{let vXLw = item.querySelector('.test-vXLw').textContent.toLowerCase();let vqk8 = item.querySelector('.test-vqk8').textContent.toLowerCase();if(vXLw.includes(vAc9)|| vqk8.includes(vAc9)){item.style.display = 'flex';}else{item.style.display = 'none';}});}mx1f(url){window.location.href = url;}mJQ0(message){let vSS3 = document.createElement('div');vSS3.className = 'vSS3 show';vSS3.textContent = message;document.body.appendChild(vSS3);setTimeout(()=>{vSS3.remove();},2000);}mdEt(){}}document.addEventListener('DOMContentLoaded',()=>{window.app = new PsychTestApp();});