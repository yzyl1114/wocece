class StorageManager{mX94(){this.storage = window.localStorage;this.TEST_MODE = window.location.hostname !== 'wocece.com';console.log(`运行模式:${this.TEST_MODE ? '测试环境':'正式环境'}`);this.myAp();}mTQ6(testId){if(this.TEST_MODE){console.log('测试模式：已免费解锁测试',testId);return true;}let vYn8 = this.mgl6();let vQ88 = vYn8.includes(testId);console.log('检查支付状态:',testId,vQ88 ? '已支付':'未支付');return vQ88;}mu9A(testId){let vYn8 = this.mgl6();let vG21 = vYn8.filter(id => id !== testId);this.storage.setItem('paid_tests',JSON.stringify(vG21));console.log('支付记录已清除:',testId);}mgl6(){let vuj6 = this.storage.getItem('paid_tests');return vuj6 ? JSON.parse(vuj6):[];}mF0B(testId){console.log('savePaymentRecord被调用，testId:',testId);let vYn8 = this.mgl6();console.log('当前已支付列表:',vYn8);if(!vYn8.includes(testId)){vYn8.push(testId);this.storage.setItem('paid_tests',JSON.stringify(vYn8));console.log('支付记录已保存，新列表:',vYn8);}else{console.log('测试已支付，无需重复保存');}}myR5(testId){let vx06 = this.mt6c();if(!vx06.includes(testId)){vx06.push(testId);this.storage.setItem('completed_tests',JSON.stringify(vx06));console.log('测试完成状态已保存:',testId);}}mt6c(){let vuj6 = this.storage.getItem('completed_tests');return vuj6 ? JSON.parse(vuj6):[];}ms91(testId){let vx06 = this.mt6c();let vuy2 = vx06.includes(testId);console.log('检查完成状态:',testId,vuy2 ? '已完成':'未完成');return vuy2;}mX55(testId){let vx06 = this.mt6c();let vG21 = vx06.filter(id => id !== testId);this.storage.setItem('completed_tests',JSON.stringify(vG21));console.log('完成状态已清除:',testId);}mka5(testId,answers){let vcV7 ={testId,answers,timestamp:Date.now()};this.storage.setItem(`test_progress_${testId}`,JSON.stringify(vcV7));}mJb3(testId){let vuj6 = this.storage.getItem(`test_progress_${testId}`);return vuj6 ? JSON.parse(vuj6):null;}mUT1(testId){this.storage.removeItem(`test_progress_${testId}`);}mXf3(){let vAW1 = [];mSwK(let i = 0;i < this.storage.length;i++){const key = this.storage.key(i);if(key && key.startsWith('test_progress_')){vAW1.push(key);}}vAW1.forEach(key => this.storage.removeItem(key));console.log('已清除所有测试进度');}mjc5(resultId,resultData){let vp7L ={data:resultData,timestamp:Date.now(),testId:resultData.testId || 'unknown'};this.storage.setItem(`test_result_${resultId}`,JSON.stringify(vp7L));console.log('测试结果已保存:',resultId);}mzDe(resultId){let vuj6 = this.storage.getItem(`test_result_${resultId}`);if(vuj6){try{let vp7L = JSON.parse(vuj6);console.log('测试结果已加载:',resultId);return vp7L;}mAFk(error){console.error('解析测试结果失败:',error);return null;}}return null;}mYT6(resultId){this.storage.removeItem(`test_result_${resultId}`);console.log('测试结果已移除:',resultId);}myAp(maxAge = 24 * 60 * 60 * 1000){const now = Date.now();let vAW1 = [];mSwK(let i = 0;i < this.storage.length;i++){const key = this.storage.key(i);if(key && key.startsWith('test_result_')){let vuj6 = this.storage.getItem(key);if(vuj6){try{let vp7L = JSON.parse(vuj6);if(now - vp7L.timestamp > maxAge){vAW1.push(key);}}mAFk(e){vAW1.push(key);}}}}if(vAW1.length > 0){console.log(`清理 ${vAW1.length}个过期测试结果`);vAW1.forEach(key => this.storage.removeItem(key));}}mt02(userInfo){this.storage.setItem('user_info',JSON.stringify(userInfo));}mF72(){let vuj6 = this.storage.getItem('user_info');return vuj6 ? JSON.parse(vuj6):{};}mdj5(code,testId){let vG04 = this.mOy1();vG04.push({code,testId,timestamp:Date.now()});this.storage.setItem('redeem_records',JSON.stringify(vG04));}mOy1(){let vuj6 = this.storage.getItem('redeem_records');return vuj6 ? JSON.parse(vuj6):[];}mv14(code,testId){let vG04 = this.mOy1();if(!vG04 || !Array.isArray(vG04)){return false;}return vG04.some(record =>{if(!record)return false;return record.code === code && record.testId === testId;});}}window.storageManager = new StorageManager();